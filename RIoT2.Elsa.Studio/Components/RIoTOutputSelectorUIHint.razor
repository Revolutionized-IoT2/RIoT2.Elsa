@inherits StudioComponentBase

@using global::Elsa.Studio.Components
@using global::Elsa.Studio.Models

<MudAutocomplete @bind-Value="_value" 
                    SearchFunc="@Search"
                    Label="@_label"
                    Margin="@_margin"
                    Dense="@_dense"
                    Disabled="@_disabled"
                    ReadOnly="@_readonly"
                    Placeholder="@(_placeholder ? "Placeholder" : null)"
                    HelperText="@(_helperText ? "Helper Text" : null)"
                    HelperTextOnFocus="_helperTextOnFocus"
                    Clearable="_clearable"
                    Modal="_modal" />
<MudItem xs="12" md="12">
    <MudText Class="mb-n3" Typo="Typo.body2">
        <MudChip T="string" Label="true" Size="Size.Small">@(_value ?? "Not selected")</MudChip>
    </MudText>
</MudItem>

@code {
    [Parameter]
    public DisplayInputEditorContext EditorContext { get; set; } = default!;


    public required string _value;
    public Margin _margin = Margin.None;
    public bool _dense = false;
    public bool _disabled = false;
    public bool _readonly = false;
    public bool _placeholder = false;
    public bool _helperText = false;
    public bool _helperTextOnFocus = false;
    public bool _clearable = false;
    public bool _modal = true;
    public string _label = "Select a US State";

    public string[] _states =
    {
        "Alabama", "Alaska", "Arizona", "Arkansas", "California",
        "Colorado", "Connecticut", "Delaware", "Florida", "Georgia",
        "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas",
        "Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts",
        "Michigan", "Minnesota", "Mississippi", "Missouri", "Montana",
        "Nebraska", "Nevada", "New Hampshire", "New Jersey", "New Mexico",
        "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma",
        "Oregon", "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota",
        "Tennessee", "Texas", "Utah", "Vermont", "Virginia",
        "Washington", "West Virginia", "Wisconsin", "Wyoming"
    };

    public async Task<IEnumerable<string>> Search(string value, CancellationToken token)
    {
        // In real life use an asynchronous function for fetching data from an api.
        await Task.Delay(5, token);

        // if text is null or empty, show complete list
        if (string.IsNullOrEmpty(value))
        {
            return _states;
        }

        return _states.Where(x => x.Contains(value, StringComparison.InvariantCultureIgnoreCase));
    }
}
